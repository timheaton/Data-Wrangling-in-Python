import pandas as pd
import numpy
from pydqc import infer_schema, data_summary, data_compare, data_consist
import os

input_directory = ("T:/test/")
output_directory = ("T:/test/EDA_test/")
file_type = (".csv")
#output_file_name = ('Merged_JOBS')

#DO NOT CHANGE THE CODE IN THIS BLOCK
os.chdir(output_directory) #out to this folder

import pandas as pd

for file in os.listdir(os.fsencode(input_directory)):
    filename = os.fsdecode(file)
    if filename.endswith(file_type):
        #code below creates data dictionaries.
        #"input_directory+file.decode("utf-8")), fname=file.decode("utf-8")[:-4] is desginrf to splice and slice names for file creation.
        infer_schema.infer_schema(pd.read_csv(input_directory+file.decode("utf-8")), fname=file.decode("utf-8")[:-4], output_root=output_directory, 
                          sample_size=1.0, type_threshold=0.5, n_jobs=2, base_schema=None)
        #mainfile = infer_schema.infer_schema(data=filename,fname=file.decode("utf-8"), output_root=output_directory, sample_size=1.0, type_threshold=0.5, n_jobs=2, base_schema=None)
       
        #mainfile.to_csv(output_file_name+file_type, mode='a',index=False)
#END OF BLOCK
